"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[7458],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return d}});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),m=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=m(e.components);return a.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),u=m(n),d=r,g=u["".concat(s,".").concat(d)]||u[d]||p[d]||o;return n?a.createElement(g,i(i({ref:t},c),{},{components:n})):a.createElement(g,i({ref:t},c))}));function d(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=u;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:r,i[1]=l;for(var m=2;m<o;m++)i[m]=n[m];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},88985:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return l},contentTitle:function(){return s},metadata:function(){return m},toc:function(){return c},default:function(){return u}});var a=n(87462),r=n(63366),o=(n(67294),n(3905)),i=["components"],l={sidebar_position:1},s="Game Loop",m={unversionedId:"game/game",id:"game/game",isDocsHomePage:!1,title:"Game Loop",description:"Items are handled separately, to make it easier for the other services.",source:"@site/docs/game/game.md",sourceDirName:"game",slug:"/game/game",permalink:"/docs/game/game",editUrl:"https://github.com/The-Microservice-Dungeon/docs/edit/main/docs/game/game.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Game Service Overview",permalink:"/docs/game_entry"},next:{title:"Commands",permalink:"/docs/game/commands"}},c=[{value:"Events",id:"events",children:[{value:"Before a game",id:"before-a-game",children:[]},{value:"During a game",id:"during-a-game",children:[]},{value:"Game ending",id:"game-ending",children:[]}]},{value:"Cheat Sheet",id:"cheat-sheet",children:[]},{value:"Repository Link Game",id:"repository-link-game",children:[]}],p={toc:c};function u(e){var t=e.components,l=(0,r.Z)(e,i);return(0,o.kt)("wrapper",(0,a.Z)({},p,l,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"game-loop"},"Game Loop"),(0,o.kt)("p",null,"Items are handled separately, to make it easier for the other services.\nThe Item use is always before the normal corresponding action.\nThe current phases of the execution part of a round are these(for more information look in the technical views of ",(0,o.kt)("a",{parentName:"p",href:"/docs/robot_entry"},"robot")," and ",(0,o.kt)("a",{parentName:"p",href:"/docs/trading/trading_entry"},"trading"),"):"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"1. Blocking \n2. Trading\n3. Moving (with an item)\n4. Moving (without an item)\n5. Repairing\n6. Battleing (with an item)\n7. Battleing(without an item)\n8. Mining\n9. Regenerating\n")),(0,o.kt)("h2",{id:"events"},"Events"),(0,o.kt)("h3",{id:"before-a-game"},"Before a game"),(0,o.kt)("p",null,"Before the start of a game there are these three game service related events."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Game Created")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},'Player "name" joined the game. (optional, if no player joins then this event is not produced)')),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("em",{parentName:"p"},"Excursus:")," The game world is created through a REST call to the ",(0,o.kt)("a",{parentName:"p",href:"/docs/map_entry"},"map service"),". The game world is automatically sized to the created game maximal player and round amount."))),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},(0,o.kt)("strong",{parentName:"p"},"POST"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"http://{defaultHost}/gameworlds\n")),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},(0,o.kt)("strong",{parentName:"p"},"example request payload"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'{\n"gameworld": {\n    "player_amount": 100,\n    "round_amount": 1000\n}\n}\n')),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"The map service is producing an event for the created game world in the channel ",(0,o.kt)("strong",{parentName:"li"},"gameworld-created"))),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},(0,o.kt)("strong",{parentName:"p"},"example event payload"))),(0,o.kt)("p",null,'{\n"id": "497f6eca-6276-4993-bfeb-53cbbbba6f08",\n"spacestation_ids": ','[\n"497f6eca-6276-4993-bfeb-53cbbbba6f08"\n]',',\n"status": "active"\n}'),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Game started")),(0,o.kt)("h3",{id:"during-a-game"},"During a game"),(0,o.kt)("p",null,"In the gameplay there is a loop of repeating events:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Round x started (With round x started event automatically begins the command collection phase, where all the players send their commands to the game service)")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Command Input ended. (after this event the game service is distributing the commands as packages to the other services for every possible command type in the correct phase order. The services execute the commands directly after receiving it. The other services have no awareness about phases. The resolution of all commands can be traced by searching the in the response of the command REST call received ",(0,o.kt)("inlineCode",{parentName:"p"},"transactionId"),")")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Round x ended.(After this event a new round will start. Here you can adjust your strategy, after receiving all responses to all actions )"))),(0,o.kt)("h3",{id:"game-ending"},"Game ending"),(0,o.kt)("p",null,"The final event is:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Game ended(with this event a game ends. No commands can be issued anymore. GameLog service should provide a scoreboard and trophies. When a new game starts, you have to join it again to play.)")),(0,o.kt)("h2",{id:"cheat-sheet"},"Cheat Sheet"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Game Timeline",src:n(99334).Z})),(0,o.kt)("h2",{id:"repository-link-game"},"Repository Link Game"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://github.com/The-Microservice-Dungeon/game/tree/main/src/main/kotlin/microservice/dungeon/game/aggregates"},"Repository Link Game")))}u.isMDXComponent=!0},99334:function(e,t,n){t.Z=n.p+"assets/images/gameTimeline-2119ca5d718e567ad3d91e0936295722.png"}}]);